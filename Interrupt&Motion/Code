// Global variables
const int reading = A0;
const int motionPin = 2;

// setup function which runs only once
void setup()
{
  //braud rate for serial communication
  Serial.begin(9600);
  // setting pin modes as output & input
  pinMode(7, OUTPUT);
  pinMode(6, OUTPUT);
  pinMode(5, OUTPUT);
  pinMode(4, OUTPUT);
  pinMode(motionPin, INPUT);
  
  // adding a interrupt for motion sensor
  attachInterrupt(digitalPinToInterrupt(motionPin), detectMotion, CHANGE);
}

// loop will run continously
void loop()
{
  // converting the value from sensor and printing it on serial monitor
  int value = analogRead(reading);
  float Moisture = value * 500.0 / 1023.0;
  Serial.println(Moisture);
  
  // changing the color of the LED depending upon moisture
  if (Moisture > 200 && Moisture < 300)
  {
   digitalWrite(7, LOW);
   digitalWrite(6, LOW);
   digitalWrite(5, HIGH);
  }
  else if (Moisture < 200)
  {
    digitalWrite(7, HIGH);
    digitalWrite(6, LOW);
    digitalWrite(5, LOW);
  }
  else if (Moisture > 300)
  {
   digitalWrite(7, LOW);
   digitalWrite(6, HIGH);
   digitalWrite(5, LOW);
  }
  delay(200);
}

// interrupt function which is called whenever interrupted
// It doesn't interfare the loop function
void detectMotion() {
  if (digitalRead(motionPin) == HIGH) {
    digitalWrite(4, HIGH);  
  }
  else {
    digitalWrite(4, LOW);  
  }
}
